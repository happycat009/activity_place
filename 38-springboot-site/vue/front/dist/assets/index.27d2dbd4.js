var L=Object.defineProperty,N=Object.defineProperties;var U=Object.getOwnPropertyDescriptors;var j=Object.getOwnPropertySymbols;var O=Object.prototype.hasOwnProperty,Y=Object.prototype.propertyIsEnumerable;var P=(e,t,o)=>t in e?L(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,V=(e,t)=>{for(var o in t||(t={}))O.call(t,o)&&P(e,o,t[o]);if(j)for(var o of j(t))Y.call(t,o)&&P(e,o,t[o]);return e},A=(e,t)=>N(e,U(t));/* empty css             *//* empty css                        *//* empty css                    *//* empty css               *//* empty css                  *//* empty css                   */import{V as B,W as k,o as d,q as w,d as c,w as f,F as T,D as M,c as D,b as v,ai as z,x as y,B as C,ae as G,aj as H,af as W,s as X,v as Z,ag as q,r as F,Y as J,Z as K,ak as Q,al as ee,a2 as te,g as R,X as oe,P as ae}from"./vendor.94a1cd75.js";import{r as x,U as $,a as se}from"./index.4c3bf3be.js";import{_ as S}from"./plugin-vue_export-helper.21dcd24c.js";/* empty css                     *//* empty css               *//* empty css                 */import{Y as ne}from"./YhPopup.79ec4c59.js";import{u as re}from"./useCheckIdCard.98c4e3d5.js";import"./useGetCollectionDesc.6b6a7e16.js";import"./moment.08a7f518.js";import{p as le}from"./regular.e69cabff.js";/* empty css                     */const de=(e,t)=>{const o={methodname:"A404",loginid:e,tel:t};return new Promise((n,p)=>{x("/frontRestService/frontCommonDataRestService/getData",o).then(_=>{n(_)}).catch(_=>{p(_)})})},ie=(e,t,o,n,p,_="0")=>{const h={methodnamedesc:"\u6DFB\u52A0\u8D26\u53F7",methodname:"B103",password:t,orgid:e,loginid:o,name:n,tel:p,isadmin:_};return new Promise((g,s)=>{x("/frontRestService/frontCommonDataRestService/getData",h).then(u=>{g(u)}).catch(u=>{s(u)})})},ce=(e,t,o)=>{const n={methodnamedesc:"\u5220\u9664\u8D26\u53F7",methodname:"B202",positionid:e,userid:t,orgid:o};return new Promise((p,_)=>{x("/frontRestService/frontCommonDataRestService/getData",n).then(h=>{p(h)}).catch(h=>{_(h)})})},pe=(e,t,o)=>{const n={methodnamedesc:"B303",methodname:"B303",userid:e,loginid:t,password:o};return new Promise((p,_)=>{x("/frontRestService/frontCommonDataRestService/getData",n).then(h=>{p(h)}).catch(h=>{_(h)})})},ue=e=>{const t={methodnamedesc:"\u83B7\u53D6\u4F01\u4E1A\u6240\u6709\u767B\u5F55\u8D26\u53F7\u4FE1\u606F",methodname:"B416",aab010:e};return new Promise((o,n)=>{x("/frontRestService/frontCommonDataRestService/getData",t).then(p=>{o(p)}).catch(p=>{n(p)})})};const E=e=>(X("data-v-0241ade2"),e=e(),Z(),e),me={class:"custom-table-wrapper"},fe=["disabled"],_e=E(()=>y("i",{class:"iconfont iconfont-delete"},null,-1)),be=[_e],he={key:1,disabled:""},ge=E(()=>y("i",{class:"iconfont iconfont-delete"},null,-1)),we=[ge],ve=["onClick"],ye=E(()=>y("i",{class:"iconfont iconfont-reset-password"},null,-1)),De=[ye],ke=["onClick","disabled"],xe=E(()=>y("i",{class:"iconfont iconfont-reset-password"},null,-1)),Ce=[xe],Ee={class:"loginid-wrapper"},Ie={key:0},Re={key:1},Se={key:0,class:"positionname"},je={key:1,class:"positionname son"},Pe={props:{tableData:{type:[Array],default:()=>[]}},emits:["resetPassword","delete"],setup(e,{emit:t}){const o=B(),n=k(()=>o.state[$]),p=k(()=>{let s=!1;const{positionInfo:u}=n.value;return u.isadmin=="1"&&(s=!0),s}),_=[{prop:"index",label:"\u5E8F\u53F7"},{prop:"positionname",label:"\u8D26\u53F7\u7C7B\u578B"},{prop:"loginid",label:"\u8D26\u53F7"},{prop:"name",label:"\u59D3\u540D"},{prop:"tel",label:"\u8054\u7CFB\u65B9\u5F0F"},{prop:"delete",label:"\u5220\u9664"},{prop:"reset",label:"\u91CD\u7F6E\u5BC6\u7801"}],h=s=>{t("delete",s)},g=s=>{t("resetPassword",s)};return(s,u)=>{const r=G,l=H,m=W;return d(),w("div",me,[c(m,{ref:"tableDom",data:e.tableData,style:{width:"100%"},border:""},{default:f(()=>[(d(),w(T,null,M(_,(a,i)=>(d(),w(T,{key:a.prop},[a.prop=="index"?(d(),D(r,{key:0,prop:a.prop,align:"center",type:"index","header-align":"center",label:a.label,width:60},null,8,["prop","label"])):a.prop=="delete"?(d(),D(r,{key:1,prop:a.prop,align:"center","header-align":"center",label:a.label,width:"100px"},{default:f(b=>[c(l,{title:"\u60A8\u662F\u5426\u786E\u5B9A\u5220\u9664\u8BE5\u8D26\u53F7\uFF1F","confirm-button-text":"\u786E\u5B9A","cancel-button-text":"\u53D6\u6D88",icon:v(z),"icon-color":"red",onConfirm:I=>h(b.row)},{reference:f(()=>[v(p)?(d(),w("button",{key:0,disabled:b.row.isadmin=="1"},be,8,fe)):(d(),w("button",he,we))]),_:2},1032,["icon","onConfirm"])]),_:2},1032,["prop","label"])):a.prop=="reset"?(d(),D(r,{key:2,prop:a.prop,align:"center","header-align":"center",label:a.label,width:"100px"},{default:f(b=>[v(p)?(d(),w("button",{key:0,onClick:I=>g(b.row)},De,8,ve)):(d(),w("button",{key:1,onClick:I=>g(b.row),disabled:b.row.loginid!=v(n).loginid},Ce,8,ke))]),_:2},1032,["prop","label"])):a.prop=="loginid"?(d(),D(r,{key:3,prop:a.prop,align:"center","header-align":"center",label:a.label,width:"200px"},{default:f(b=>[y("div",Ee,[b.row.isEncryptLoginid?(d(),w("span",Ie,C(b.row.encryptLoginid),1)):(d(),w("span",Re,C(b.row.loginid),1))])]),_:2},1032,["prop","label"])):a.prop=="positionname"?(d(),D(r,{key:4,prop:a.prop,align:"center","header-align":"center",label:a.label,width:"200px"},{default:f(b=>[b.row.isadmin=="1"?(d(),w("div",Se,C(b.row.positionname),1)):(d(),w("div",je,C(b.row.positionname),1))]),_:2},1032,["prop","label"])):(d(),D(r,{key:5,prop:a.prop,align:"center","header-align":"center",label:a.label,"show-overflow-tooltip":""},null,8,["prop","label"]))],64))),64))]),_:1},8,["data"])])}}};var Ve=S(Pe,[["__scopeId","data-v-0241ade2"]]);const Ae=e=>{if(!e)return console.error("\u672A\u4F20\u5165\u8EAB\u4EFD\u8BC1\u53F7"),"";let t=e.length;return e.substr(0,1)+"*".repeat(t-2)+e.substr(t-1,t)};const Be={class:"form-wrapper"},Te={class:"button-wrapper"},qe={props:{show:{type:Boolean,required:!0},popupTitle:{type:String,default:()=>""},formData:{type:Object,default:()=>({})}},emits:["update:show","addSuccess"],setup(e,{emit:t}){const o=e,n=q(null),p=F({loginid:[{required:!0,message:"\u8BF7\u8F93\u5165\u8EAB\u4EFD\u8BC1\u53F7",trigger:"blur"},{validator:re,trigger:"blur"}],name:[{required:!0,message:"\u8BF7\u8F93\u5165\u59D3\u540D",trigger:"blur"}],tel:[{required:!0,message:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7",trigger:"blur"},{pattern:le,trigger:"blur",message:"\u8BF7\u8F93\u516511\u4F4D\u6B63\u786E\u7684\u624B\u673A\u53F7"}],password:[{required:!0,message:"\u8BF7\u8F93\u5165\u5BC6\u7801",trigger:"blur"}]}),_=()=>{const{userid:g,orgid:s,password:u,loginid:r,name:l,tel:m,isadmin:a,isEdit:i}=o.formData;i?pe(g,r,u).then(b=>{R.success("\u8D26\u53F7\u91CD\u7F6E\u5BC6\u7801\u6210\u529F"),t("update:show",!1)}):de(r,m).then(b=>{ie(s,u,r,l,m,a).then(I=>{R.success("\u8D26\u53F7\u6DFB\u52A0\u6210\u529F"),t("update:show",!1),t("addSuccess")})})},h=g=>{g.validate((s,u)=>{if(s)_();else{const r=[];for(let m in u)r.push(m);const l=r[0];g.scrollToField(l)}})};return(g,s)=>{const u=J,r=K,l=Q,m=ee,a=te;return d(),D(ne,{modelValue:e.show,popupName:e.popupTitle,maskClose:!1,"onUpdate:modelValue":s[5]||(s[5]=i=>t("update:show",i))},{default:f(()=>[y("div",Be,[c(a,{ref_key:"formRef",ref:n,model:e.formData,rules:v(p)},{default:f(()=>[c(m,null,{default:f(()=>[c(l,{span:12},{default:f(()=>[c(r,{label:"\u8D26\u53F7\uFF1A",prop:"loginid"},{default:f(()=>[c(u,{modelValue:e.formData.loginid,"onUpdate:modelValue":s[0]||(s[0]=i=>e.formData.loginid=i),placeholder:"\u8BF7\u8F93\u5165\u8EAB\u4EFD\u8BC1\u53F7",type:"text",disabled:e.formData.isEdit,maxlength:"18"},null,8,["modelValue","disabled"])]),_:1})]),_:1}),c(l,{span:12,class:"space"},{default:f(()=>[c(r,{label:"\u59D3\u540D\uFF1A",prop:"name"},{default:f(()=>[c(u,{modelValue:e.formData.name,"onUpdate:modelValue":s[1]||(s[1]=i=>e.formData.name=i),placeholder:"\u8BF7\u8F93\u5165\u59D3\u540D",disabled:e.formData.isEdit,type:"text",maxlength:"4"},null,8,["modelValue","disabled"])]),_:1})]),_:1})]),_:1}),c(m,null,{default:f(()=>[c(l,{span:12},{default:f(()=>[c(r,{label:"\u8054\u7CFB\u65B9\u5F0F\uFF1A",prop:"tel"},{default:f(()=>[c(u,{modelValue:e.formData.tel,"onUpdate:modelValue":s[2]||(s[2]=i=>e.formData.tel=i),placeholder:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7\u7801",disabled:e.formData.isEdit,type:"text",maxlength:"11"},null,8,["modelValue","disabled"])]),_:1})]),_:1}),c(l,{span:12,class:"space"},{default:f(()=>[c(r,{label:"\u5BC6\u7801\uFF1A",prop:"password"},{default:f(()=>[c(u,{modelValue:e.formData.password,"onUpdate:modelValue":s[3]||(s[3]=i=>e.formData.password=i),placeholder:"\u8BF7\u8F93\u5165\u5BC6\u7801",type:"text"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"]),y("div",Te,[y("button",{class:"primary",onClick:s[4]||(s[4]=i=>h(n.value))},"\u786E\u5B9A")])])]),_:1},8,["modelValue","popupName"])}}};var Fe=S(qe,[["__scopeId","data-v-7c75cca2"]]);const $e={class:"enterprise-account"},Le={key:0,class:"button-wrapper"},Ne={setup(e){const t=B(),o=q(!1),n=F({popupTitle:"\u6DFB\u52A0\u4F01\u4E1A\u7ECF\u529E\u8D26\u53F7",accountInfo:{loginid:"",name:"",tel:"",password:"",orgid:"",isadmin:"0",isEdit:!1},accountList:[]}),p=k(()=>t.state[se]),_=k(()=>t.state[$]),h=k(()=>{let l=!1;const{positionInfo:m}=_.value;return m.isadmin=="1"&&(l=!0),l}),g=async()=>{const{aab010:l}=p.value,m=await ue(l),{userList:a}=m.data;a.map(i=>{i.isEncryptLoginid=!0,i.encryptLoginid=Ae(i.loginid)}),n.accountList=a},s=()=>{n.accountInfo={loginid:"",name:"",tel:"",password:"",orgid:_.value.orgid,isadmin:"0",isEdit:!1},o.value=!0,n.popupTitle="\u6DFB\u52A0\u4F01\u4E1A\u7ECF\u529E\u8D26\u53F7"},u=l=>{n.accountInfo=A(V({},l),{password:"",isEdit:!0}),n.popupTitle="\u4FEE\u6539\u7ECF\u529E\u8D26\u53F7",o.value=!0},r=l=>{const{positionid:m,userid:a,orgid:i}=l;ce(m,a,i).then(()=>{R.success("\u5220\u9664\u6210\u529F"),g()})};return oe(()=>{g()}),(l,m)=>(d(),w("div",$e,[v(h)?(d(),w("div",Le,[y("button",{class:"primary",onClick:s}," \u6DFB\u52A0\u4F01\u4E1A\u7ECF\u529E\u8D26\u53F7 ")])):ae("",!0),c(Ve,{tableData:v(n).accountList,onResetPassword:u,onDelete:r},null,8,["tableData"]),c(Fe,{show:o.value,"onUpdate:show":m[0]||(m[0]=a=>o.value=a),popupTitle:v(n).popupTitle,formData:v(n).accountInfo,onAddSuccess:g},null,8,["show","popupTitle","formData"])]))}};var rt=S(Ne,[["__scopeId","data-v-18f61bdf"]]);export{rt as default};
