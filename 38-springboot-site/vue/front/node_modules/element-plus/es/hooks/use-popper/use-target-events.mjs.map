{"version":3,"file":"use-target-events.mjs","sources":["../../../../../packages/hooks/use-popper/use-target-events.ts"],"sourcesContent":["import { computed, getCurrentInstance } from 'vue'\nimport { isArray } from '@element-plus/utils/util'\n\nexport type TriggerType = 'click' | 'hover' | 'focus' | 'manual'\nexport type Trigger = TriggerType | TriggerType[]\n\nexport interface PopperEvents {\n  onClick?: (e: Event) => void\n  onMouseenter?: (e: Event) => void\n  onMouseleave?: (e: Event) => void\n  onFocus?: (e: Event) => void\n  onBlur?: (e: Event) => void\n}\n\nexport const DEFAULT_TRIGGER = 'hover'\n\ntype Handler = () => void\n\nexport const useTargetEvents = (\n  onShow: Handler,\n  onHide: Handler,\n  onToggle: Handler\n) => {\n  const { props } = getCurrentInstance()!\n\n  let triggerFocused = false\n\n  const popperEventsHandler = (e: Event) => {\n    e.stopPropagation()\n    switch (e.type) {\n      case 'click': {\n        if (triggerFocused) {\n          // reset previous focus event\n          triggerFocused = false\n        } else {\n          onToggle()\n        }\n        break\n      }\n      case 'mouseenter': {\n        onShow()\n        break\n      }\n      case 'mouseleave': {\n        onHide()\n        break\n      }\n      case 'focus': {\n        triggerFocused = true\n        onShow()\n        break\n      }\n      case 'blur': {\n        triggerFocused = false\n        onHide()\n        break\n      }\n    }\n  }\n\n  const triggerEventsMap: Partial<Record<TriggerType, (keyof PopperEvents)[]>> =\n    {\n      click: ['onClick'],\n      hover: ['onMouseenter', 'onMouseleave'],\n      focus: ['onFocus', 'onBlur'],\n    }\n\n  const mapEvents = (t: TriggerType) => {\n    const events = {} as PopperEvents\n    triggerEventsMap[t]?.forEach((event) => {\n      events[event] = popperEventsHandler\n    })\n\n    return events\n  }\n\n  return computed(() => {\n    if (isArray(props.trigger)) {\n      return Object.values(props.trigger).reduce((pre, t) => {\n        return {\n          ...pre,\n          ...mapEvents(t),\n        }\n      }, {})\n    } else {\n      return mapEvents(props.trigger as TriggerType)\n    }\n  })\n}\n"],"names":[],"mappings":";;;;AAEY,MAAC,eAAe,GAAG,QAAQ;AAC3B,MAAC,eAAe,GAAG,CAAC,MAAM,EAAE,MAAM,EAAE,QAAQ,KAAK;AAC7D,EAAE,MAAM,EAAE,KAAK,EAAE,GAAG,kBAAkB,EAAE,CAAC;AACzC,EAAE,IAAI,cAAc,GAAG,KAAK,CAAC;AAC7B,EAAE,MAAM,mBAAmB,GAAG,CAAC,CAAC,KAAK;AACrC,IAAI,CAAC,CAAC,eAAe,EAAE,CAAC;AACxB,IAAI,QAAQ,CAAC,CAAC,IAAI;AAClB,MAAM,KAAK,OAAO,EAAE;AACpB,QAAQ,IAAI,cAAc,EAAE;AAC5B,UAAU,cAAc,GAAG,KAAK,CAAC;AACjC,SAAS,MAAM;AACf,UAAU,QAAQ,EAAE,CAAC;AACrB,SAAS;AACT,QAAQ,MAAM;AACd,OAAO;AACP,MAAM,KAAK,YAAY,EAAE;AACzB,QAAQ,MAAM,EAAE,CAAC;AACjB,QAAQ,MAAM;AACd,OAAO;AACP,MAAM,KAAK,YAAY,EAAE;AACzB,QAAQ,MAAM,EAAE,CAAC;AACjB,QAAQ,MAAM;AACd,OAAO;AACP,MAAM,KAAK,OAAO,EAAE;AACpB,QAAQ,cAAc,GAAG,IAAI,CAAC;AAC9B,QAAQ,MAAM,EAAE,CAAC;AACjB,QAAQ,MAAM;AACd,OAAO;AACP,MAAM,KAAK,MAAM,EAAE;AACnB,QAAQ,cAAc,GAAG,KAAK,CAAC;AAC/B,QAAQ,MAAM,EAAE,CAAC;AACjB,QAAQ,MAAM;AACd,OAAO;AACP,KAAK;AACL,GAAG,CAAC;AACJ,EAAE,MAAM,gBAAgB,GAAG;AAC3B,IAAI,KAAK,EAAE,CAAC,SAAS,CAAC;AACtB,IAAI,KAAK,EAAE,CAAC,cAAc,EAAE,cAAc,CAAC;AAC3C,IAAI,KAAK,EAAE,CAAC,SAAS,EAAE,QAAQ,CAAC;AAChC,GAAG,CAAC;AACJ,EAAE,MAAM,SAAS,GAAG,CAAC,CAAC,KAAK;AAC3B,IAAI,IAAI,EAAE,CAAC;AACX,IAAI,MAAM,MAAM,GAAG,EAAE,CAAC;AACtB,IAAI,CAAC,EAAE,GAAG,gBAAgB,CAAC,CAAC,CAAC,KAAK,IAAI,GAAG,KAAK,CAAC,GAAG,EAAE,CAAC,OAAO,CAAC,CAAC,KAAK,KAAK;AACxE,MAAM,MAAM,CAAC,KAAK,CAAC,GAAG,mBAAmB,CAAC;AAC1C,KAAK,CAAC,CAAC;AACP,IAAI,OAAO,MAAM,CAAC;AAClB,GAAG,CAAC;AACJ,EAAE,OAAO,QAAQ,CAAC,MAAM;AACxB,IAAI,IAAI,OAAO,CAAC,KAAK,CAAC,OAAO,CAAC,EAAE;AAChC,MAAM,OAAO,MAAM,CAAC,MAAM,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC,MAAM,CAAC,CAAC,GAAG,EAAE,CAAC,KAAK;AAC7D,QAAQ,OAAO;AACf,UAAU,GAAG,GAAG;AAChB,UAAU,GAAG,SAAS,CAAC,CAAC,CAAC;AACzB,SAAS,CAAC;AACV,OAAO,EAAE,EAAE,CAAC,CAAC;AACb,KAAK,MAAM;AACX,MAAM,OAAO,SAAS,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC;AACtC,KAAK;AACL,GAAG,CAAC,CAAC;AACL;;;;"}